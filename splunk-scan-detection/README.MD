# Laboratorio de Detecci贸n de Escaneo de Red Interno con Splunk

---

##  Introducci贸n

Este laboratorio tiene como objetivo simular un escenario de reconocimiento dentro de una red interna, donde un atacante intenta descubrir otros sistemas mediante t茅cnicas de escaneo.

Utilizaremos **Splunk** para analizar los patrones generados por la herramienta **Nmap** y aprender a detectar actividad sospechosa basada en el volumen y tipo de conexiones iniciadas.

---

##  Objetivos

* Simular un escaneo de red horizontal y vertical.
* Capturar y visualizar los logs de red en Splunk.
* Aplicar consultas SPL para detectar escaneos.
* Crear alertas autom谩ticas por patrones de escaneo.
* Relacionar la actividad con t茅cnicas MITRE ATT\&CK.

---

##  Infraestructura

| M谩quina    | IP              | Rol             |
| ---------- | --------------- | --------------- |
| Kali Linux | 192.168.100.110 | Atacante (Nmap) |
| Windows 10 | 192.168.100.120 | V铆ctima         |
| Ubuntu     | 192.168.100.129 | Servidor Splunk |

---

##  Herramientas utilizadas

| Herramienta      | Descripci贸n                             |
| ---------------- | --------------------------------------- |
| Nmap             | Escaneo de red (puertos/hosts)          |
| Splunk           | An谩lisis y visualizaci贸n de logs        |
| Wireshark o Zeek | (Opcional) Captura o generaci贸n de logs |

---

## 锔 Simulaci贸n de escaneo

Desde la m谩quina atacante Kali:

Escaneo horizontal:

```bash
nmap -sS 192.168.100.0/24
```

Escaneo de puertos vertical:

```bash
nmap -sS -p- 192.168.100.120
```

---

##  Recolecci贸n de logs

* Habilitar el logueo de conexiones en firewall o usar logs de IDS/Zeek.
* O usar Wireshark para capturar el pcap y convertirlo a CSV para subirlo a Splunk.

---

##  An谩lisis en Splunk (SPL)

Ejemplo de consulta para detectar m煤ltiples conexiones por IP:

```spl
index=red_logs action=blocked OR protocol=tcp
| stats count by src_ip, dest_ip, dest_port
| where count > 100
```

---

##  Visualizaci贸n

* Heatmap de IP origen vs puertos destino.
* Top 10 IPs con m谩s intentos.
* Timeline de volumen de conexiones por minuto.

---

## 锔 Alerta programada

* Disparar alerta si una IP genera >200 intentos a distintos puertos en <1 minuto.
* Otra alerta si una misma IP intenta conectarse a >10 hosts en <5 minutos.

---

##  MITRE ATT\&CK relacionado

| T茅cnica                   | ID    |
| ------------------------- | ----- |
| Network Service Discovery | T1046 |
| Active Scanning           | T1595 |
| Remote System Discovery   | T1018 |

---

##  Evidencias a documentar

* Captura del escaneo en Kali (pantalla o comandos).
* Paneles de Splunk con gr谩ficos.
* Logs analizados.
* Captura de alerta generada.

---

##  Conclusi贸n

Este laboratorio demuestra la utilidad de Splunk para identificar t谩cticas comunes de reconocimiento utilizadas por atacantes en redes internas. Detectar escaneos tempranamente permite activar medidas proactivas de contenci贸n antes de una intrusi贸n mayor.
